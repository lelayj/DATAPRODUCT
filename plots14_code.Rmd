---
title: "14 plots showing the tests results stored in the file statistics.rds"
author:  "Joel Le Lay "
date: "2016/04/08"
output: html_document
---

This code lies in the file plots14_code.Rmd on GitHUb at the link
https://github.com/lelayj/DATAPRODUCT,    
The file plots14.rds generated by this code can be found at the link
https://github.com/lelayj/DATAPRODUCT  as well.    


```{r}
statistics <- readRDS("data/statistics.rds")
```

To see the code that gave the file statistics.rds, 
see tab STATISTICS / statistics code of the app
and STATISTICS / algorithm logic for the way the code is built.  
(or the files statistics_code.Rmd and algo_logic.txt on GitHUb at the link
https://github.com/lelayj/DATAPRODUCT)   

The result `statistics` of the execution of this code has been saved 
to the file `statistics.rds` due to the time needed for the  execution.

elapsed time:   
3596.872 + 1175.363 + 620.229 + 426.817 + 386.673 + 58.725 + 14.575 = 6279.254  
(Intel® Core™ i5-3210M CPU @ 2.50GHz × 4)  



```{r}
library(ggplot2)
```

 
```{r}
fNb <- 7 # number of forecasting methods

FUNplot14 <- function(i){# i from 1 to length(res)
        
        d0 <- statistics[[i]]
        meth <-c("Exponential Smoothing", "Seasonal naive", 
                 "Multiple regression",  "Simple regression","Mean", "Naive", "Drift" )
        
        FUNplot2 <- function(j){# j= 1,2
                
                FUNc <- function(j){
                        if(j==1){rep("", fNb)}
                        else{d0[,3]} 
                }
                c <-FUNc(j)
                d1 <- d0[j]
                d1$c <- c
                
                d <- cbind( meth, d1)   
                names(d) <- c("a", "b", "c")
                
                g1 <- ggplot( d, aes(a, b ) ) +
                        geom_bar( stat = "identity", 
                                  fill = ifelse(j==1, "lightblue", "pink") )+ 
                        scale_x_discrete(limits =  d$a ) +
                        expand_limits(x = 8) + 
                        scale_y_continuous(breaks=NULL)+
                        expand_limits(y = ifelse(j==2, max(d$b)+5, max(d$b))) + 
                        theme_bw(base_family = "Avenir", base_size=12) +
                        theme(panel.border = element_blank(),
                              axis.text.x = element_text(hjust = 0, vjust = 1,
                                                         angle = -45,  color = "blue" ,
                                                          size = 12 ),
                              axis.title.x = element_blank(),
                              axis.title.y = element_blank(),
                              plot.title = element_text( lineheight = 0.7, size = 14 )
                        ) + 
                        
                        geom_text( aes( label = b ), vjust = 1.2, size = 5, 
                                   color = ifelse(j==1, "brown", "blue") ) +
                        
                        geom_text( aes( label = c ),  vjust = -0.5, size = 4, 
                                   color = "red" ) +
                        
                        annotate("text",  x=-Inf, y=Inf,
                                 label=ifelse(j==2, "mean MAPE", ""), family="serif",
                                 color="blue", size=6, hjust=0, vjust=3) +
                        
                        annotate("text",  x=-Inf, y=Inf,
                                 label=ifelse(j==2, "standard deviation", ""), 
                                 family="serif", color="red", size=5, hjust=0, vjust=2) +
                        
                        labs( title = 
                              ifelse(j==1, "Percentage of tests for which the forecasting method ranked n°1\n", 
                                    "Mean MAPE and standard deviation for each method\n"))
                
                g1
       }
       
        g2 <-lapply(1:2, FUNplot2)
        g2
}

```

```{r}
g <- lapply(1:length(statistics), FUNplot14) 

for (i in 1:length(statistics)){
        for (j in 1:2){
           print(g[[i]][[j]])    
        }
}
```



```{r,eval=FALSE}
saveRDS(g, "plots14.rds")
```

